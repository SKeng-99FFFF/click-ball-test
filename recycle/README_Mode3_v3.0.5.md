# Aim Trainer 模式3详细说明文档

## 版本信息
**当前版本：** v3.0.5  
**版本号规范：** A.B.C  
- A: 模式数量 - 当前游戏模式的数量，增加新模式时+1，A+1时B归0
- B: 功能版本 - 实现新功能时+1，添加功能后每次修改时C归0，模式数量不变时添加新功能B+1  
- C: 修改次数 - 当前版本的修改次数，B+1或归0时C归0，或当添加功能后每次修改C+1
- 版本更新规则：A+1时B归0，B+1或归0时C归0

## 模式3 - 移动背景板模式

### 核心机制
模式3是一个独特的移动背景板模式，其核心机制与其他模式完全不同：
- **判定位置**：屏幕中心点是唯一的判定位置
- **点击逻辑**：当中心点位于任意小球范围内时，点击窗口任意位置都被判定为正确点击
- **背景移动**：鼠标移动时整个背景板（包含所有小球和方格）跟随移动，但移动方向与光标移动方向相反

### 游戏规则

#### 1. 背景板移动机制
- 鼠标在游戏区域内移动时，整个背景板（包括小球和方格）会跟随鼠标移动，但方向相反
- 例如：鼠标向右移动，背景向左移动；鼠标向下移动，背景向上移动
- 小球与方格之间的相对位置保持不变
- 营造出移动窗口中心到小球位置的感觉

#### 2. 点击判定机制
- **正确点击条件**：中心点在任意小球范围内时进行点击
- **错误点击条件**：中心点不在任何小球范围内时进行点击
- **关键特性**：一旦中心点在小球范围内，点击窗口任意位置都算正确
- **视觉反馈**：点击成功时不显示分数文本，保持简洁的视觉体验

#### 3. 视觉体验
- **光标隐藏**：进入模式3时自动隐藏光标，增加沉浸感
- **无点击效果**：点击成功时不显示分数文本，专注核心玩法
- **中心标记**：屏幕中心有红色十字标记，帮助玩家定位中心点
- **背景移动**：反向移动营造物理直觉

#### 4. 小球生成规则
- 复用模式2的生成规则：在中间3x3网格区域内生成
- 最多同时显示3个小球
- 球体直径为模式1的1.75倍
- 方格边长为球体直径的1.3倍

### 技术实现细节

#### 坐标系统
- **原始坐标**：小球在网格中的固定坐标（ball.x, ball.y）
- **移动后坐标**：原始坐标 + 偏移量（moved_ball_x = ball.x + offset_x, moved_ball_y = ball.y + offset_y）
- **中心坐标**：屏幕中心点坐标（center_x, center_y）
- **偏移计算**：offset_x = center_x - mouse_x（反向计算）

#### 点击检测算法
1. 遍历所有小球，计算移动后的小球中心位置
2. 计算中心点到每个移动后小球中心的距离
3. 如果距离 ≤ 球体半径，则中心点在该小球范围内
4. 此时无论点击位置在哪里，都判定为正确点击

#### 距离计算公式
```
distance_center_to_ball = sqrt((center_x - moved_ball_x)² + (center_y - moved_ball_y)²)
```

### 与其他模式的区别

| 特性 | 模式1 | 模式2 | 模式3 |
|------|-------|-------|-------|
| 点击判定 | 点击小球本身 | 点击小球本身 | 中心点在小球上 |
| 背景移动 | 无 | 无 | 鼠标移动时反向跟随 |
| 判定位置 | 点击位置 | 点击位置 | 屏幕中心 |
| 光标显示 | 显示 | 显示 | 隐藏（模式3中） |
| 点击效果 | 显示分数 | 显示分数 | 无（简洁视觉） |
| 小球大小 | 标准 | 1.75倍 | 1.75倍 |
| 基础分数 | 100分 | 100分 | 100分 |

### 交互体验
- **沉浸感**：隐藏光标增加专注度
- **视觉简洁**：无点击分数显示，专注核心玩法
- **物理直觉**：反向移动营造移动中心的直观感受
- **视觉反馈**：屏幕中心有红色十字标记，帮助玩家定位中心点
- **操作流畅性**：背景移动平滑，小球跟随鼠标无延迟

### 计分系统
- **基础分数**：100分
- **连击机制**：连续正确点击可获得连击奖励
- **错误惩罚**：错误点击扣100分，重置连击计数
- **点击间隔**：仅计算正确点击之间的时间间隔

### 注意事项
- 玩家需要将小球移动到中心位置（使中心点位于小球范围内）
- 一旦小球覆盖中心点，可以点击任意位置得分
- 移动鼠标时要精确控制，由于反向移动需要适应性操作
- 点击成功时不显示分数文本，保持视觉简洁
- 小球消失后会按模式2规则生成新的小球
- 游戏结束或切换模式时会恢复光标显示

## 版本更新记录

### v3.0.5 (当前版本) - 功能调整版本
- 移除模式3点击成功时的分数文本显示，提升视觉体验
- 模式3保持简洁的视觉效果，专注核心玩法
- 按照新规范：A=3(模式数量), B=0(功能版本), C=5(修改次数)

### v3.0.4 - 功能增强版本
- 添加模式3反向移动功能：背景移动与光标移动方向相反，营造移动中心的感觉
- 添加模式3隐藏光标功能：增加沉浸感
- 优化光标控制：游戏开始隐藏，结束或切换模式时恢复
- 按照新规范：A=3(模式数量), B=0(功能版本), C=4(修改次数)

### v3.0.3 - 修复版本
- 修正模式3核心逻辑：当中心点在任意小球上时点击即为正确，无论点击窗口哪个位置
- 这是模式3的关键机制：中心点位置是判定位置，不是点击位置
- 按照新规范：A=3(模式数量), B=0(功能版本), C=3(修改次数)

### v3.0.2 - 修复版本
- 修复模式3点击检测问题：正确实现小球在中心时点击的逻辑
- 修正中心检测算法：确保小球覆盖中心点时才能正确点击
- 按照新规范：A=3(模式数量), B=0(功能版本), C=2(修改次数)

### v3.0.1 - 修复版本
- 修复模式3点击检测问题：正确识别小球在中心位置时的点击
- 修复点击间隔计算问题：只计算正确点击之间的时间间隔
- 按照新规范：A=3(模式数量), B=0(功能版本), C=1(修改次数)

### v3.0.0 
- 添加新模式3：移动背景板模式
- 模式3特性：鼠标移动背景板，小球移动到中心时点击得分
- 复用模式2的球体生成规则到模式3
- 模式2和模式3基础分数调整为100分
- 按照新规范：A=3(当前有3个模式), B=0(功能版本), C=0(修改次数)